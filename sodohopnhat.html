<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>S∆° ƒë·ªì h·ªçc h·ª£p nh·∫•t ‚Äì Chuy√™n gia ƒë·ª©ng ƒë·∫ßu üåê</title>
  <meta name="description" content="H·ªá th·ªëng s∆° ƒë·ªì h·ªçc h·ª£p nh·∫•t ‚Äì tr·ª±c quan, si√™u m∆∞·ª£t, th√¢n thi·ªán di ƒë·ªông, theo d√µi ti·∫øn ƒë·ªô, t√¨m ki·∫øm t·ª©c th·ªùi, in/ghi ch√∫, m·ªôt file duy nh·∫•t." />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0b0f19" />
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Be+Vietnam+Pro:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com/3.4.1"></script>
  <script>
    tailwind.config = {
      darkMode: ['class', '[data-theme="dark"]'],
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', 'sans-serif'],
            display: ['Be Vietnam Pro','Inter','system-ui']
          },
          colors: {
            brand: {
              50:'#eef2ff',100:'#e0e7ff',200:'#c7d2fe',300:'#a5b4fc',400:'#818cf8',500:'#6366f1',600:'#4f46e5',700:'#4338ca',800:'#3730a3',900:'#312e81'
            }
          },
          boxShadow: {
            glow: '0 0 0 1px rgba(99,102,241,.2), 0 10px 30px -10px rgba(99,102,241,.6)'
          }
        }
      }
    }
  </script>
  <style>
    :root { --glow-red: rgba(255, 31, 113, 0.7); --glow-blue: rgba(0,191,255,.7); }
    html, body { height: 100%; }
    body { font-family: var(--tw-font-sans, 'Inter', system-ui); }
    main { padding-bottom: 96px; }
    .reduce-motion * { transition: none !important; animation: none !important; }
    @media (prefers-reduced-motion: reduce){ body {scroll-behavior:auto;} }
    .kbd { @apply inline-flex items-center justify-center rounded-md border border-gray-300 dark:border-white/20 px-1.5 text-[11px] h-5 leading-none; }
    .scrollbar-thin { scrollbar-width: thin; }
    .scrollbar-thin::-webkit-scrollbar{height:8px;width:8px}
    .scrollbar-thin::-webkit-scrollbar-thumb{background:rgba(100,116,139,.5);border-radius:8px}
    .shimmer{position:relative;overflow:hidden;background:linear-gradient(90deg,#e5e7eb 25%,#f3f4f6 37%,#e5e7eb 63%);background-size:400% 100%;animation:shimmer 1.6s infinite}
    @keyframes shimmer {0%{background-position:100% 0}100%{background-position:0 0}}
    /* Print */
    @media print{
      header, .cmdbar, .bottom-nav, .sheet-root, .toast { display:none !important }
      .print-break{ break-inside: avoid; page-break-inside: avoid }
      body { background:#fff; color:#111 }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 selection:bg-brand-500/30">
  <div id="root"></div>

  <!-- React 18 UMD (production) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <!-- Babel for inline JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const {useState,useEffect,useMemo,useRef,useCallback,createContext,useContext} = React;

    /* ========================= Data (domain model) ========================= */
    const DATA = {
      core: {
        id:'core-teaching',
        title:'T·∫•t C·∫£ T·ª´ M·ªôt ‚Äì Nh·∫•t Nguy√™n (Th∆∞·ª£ng ƒê·∫ø)',
        items:[
          'Th∆∞·ª£ng ƒê·∫ø l√† Ngu·ªìn G·ªëc Duy Nh·∫•t c·ªßa v·∫°n v·∫≠t, kh√¥ng c√≥ g√¨ kh√°c ngo√†i Ng√†i.',
          'Ng√†i t·ª± ph√¢n chia th√†nh v√¥ s·ªë h√¨nh t∆∞·ªõng ƒë·ªÉ tr·∫£i nghi·ªám v√† th·∫•u hi·ªÉu ch√≠nh m√¨nh.',
          'B·∫£n ch·∫•t c·ªßa Th∆∞·ª£ng ƒê·∫ø l√† s√°ng su·ªët, v√¥ h·∫°n, v∆∞·ª£t kh√¥ng gian & th·ªùi gian.',
          'M·ª•c ƒë√≠ch s·ªëng: nh·∫≠n ra B·∫£n Th·ªÉ b√™n trong ƒë·ªÉ tr·ªü v·ªÅ Nh·∫•t Nguy√™n.'
        ],
        tags:['cƒÉn-b·∫£n','nh·∫•t-nguy√™n']
      },
      sections: {
        '1':{ title:'N√¢ng Cao Tinh Th·∫ßn & S·ª©c Kh·ªèe', tags:['·ª©ng-d·ª•ng','nƒÉng-l∆∞·ª£ng'], cards:[
          {id:'suc-manh-tho-ca',title:'S·ª©c M·∫°nh Th∆° Ca & √Çm Nh·∫°c',subItems:['ƒê·ªçc, H√°t, Nghe Th∆° Ca T√≠ch C·ª±c'],tags:['√¢m-nh·∫°c','t√≠ch-c·ª±c']},
          {id:'song-co-muc-dich',title:'S·ªëng C√≥ M·ª•c ƒê√≠ch',subItems:['L·∫≠p K·∫ø Ho·∫°ch, Theo ƒêu·ªïi ƒêam M√™','Tr√°nh M·∫•t Ph∆∞∆°ng H∆∞·ªõng, Ti√™u C·ª±c'],tags:['m·ª•c-ti√™u']}
        ]},
        '2':{ title:'B·∫£o V·ªá T√¢m Tr√≠ & Tr√≠ Tu·ªá', tags:['tr√≠-tu·ªá'], cards:[
          {id:'giu-tri-tue-sang-suot',title:'Gi·ªØ Tr√≠ Tu·ªá S√°ng Su·ªët',subItems:[
            'C·∫£nh Gi√°c V·ªõi L√≤ng Tham','Ph√¢n T√≠ch, Nh·∫≠n Di·ªán C·∫°m B·∫´y','Chi·∫øn Th·∫Øng T√¢m X·∫•u √Åc','Nh·∫≠n Di·ªán Ph·∫≠t T√≠nh B√™n Trong','T·ª´ Ch·ªëi X√∫i Gi·ª•c Ti√™u C·ª±c','Chuy·ªÉn H√≥a Suy Nghƒ© Ti√™u C·ª±c'],tags:['nh·∫≠n-di·ªán','t·ªânh-th·ª©c']},
          {id:'de-phong-tam',title:'ƒê·ªÅ Ph√≤ng T√¢m & Th∆∞·ª£ng ƒê·∫ø B√™n Trong',subItems:[
            'T·ªânh Gi√°c V·ªõi Suy Nghƒ© Ti√™u C·ª±c','Ch·ªçn L·ªçc Suy Nghƒ© T√≠ch C·ª±c','H√≥a Gi·∫£i ‚ÄúMa Qu·ª∑‚Äù ·∫¢o ·∫¢nh','Nh·∫≠n Ra ·∫¢o ·∫¢nh Do Th∆∞·ª£ng ƒê·∫ø','Kh√¥ng S·ª£ H√£i, ·ª®ng X·ª≠ T√≠ch C·ª±c','Ni·ªám Ch√∫ & T·∫≠p Th·ªÉ D·ª•c H√≥a Gi·∫£i'],tags:['t·ªânh-gi√°c']},
          {id:'than-trong-loi-noi',title:'Th·∫≠n Tr·ªçng Trong L·ªùi N√≥i',subItems:['Hi·ªÉu R√µ Tr∆∞·ªõc Khi N√≥i/Vi·∫øt','Th·∫≠n Tr·ªçng B√≠ M·∫≠t Ri√™ng T∆∞','S·ªëng T·ªânh Th·ª©c'],tags:['giao-ti·∫øp']}
        ]},
        '3':{ title:'Hi·ªÉu Bi·∫øt V≈© Tr·ª• & B·∫£n Ch·∫•t', tags:['tri·∫øt-h·ªçc'], cards:[
          {id:'nguon-goc-su-song',title:'Ngu·ªìn G·ªëc S·ª± S·ªëng',subItems:['S·ª± S·ªëng Kh·∫Øp V≈© Tr·ª•','√ù Th·ª©c, B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng','Thi·ªÅn ƒê·ªãnh ƒê·ªÉ Th·∫•u Hi·ªÉu'],tags:['v≈©-tr·ª•']},
          {id:'an-nhien-truoc-thi-phi',title:'An Nhi√™n Tr∆∞·ªõc Th·ªã Phi',subItems:['Kh√¥ng B·∫≠n T√¢m L·ªùi V·ª• Kh√¥ng','Th·∫•u Hi·ªÉu Ng∆∞·ªùi Kh√°c'],tags:['an-nhi√™n']},
          {id:'nguon-goc-virus',title:'Ngu·ªìn G·ªëc Virus, Vi Khu·∫©n',subItems:['Do Th∆∞·ª£ng ƒê·∫ø T·∫°o Ra & ƒêi·ªÅu Khi·ªÉn','B·ªánh Do T·ª´ Tr∆∞·ªùng √Åc Tr∆∞·ª£c','Ng·ªô Ra ƒê·ªÉ ƒê∆∞·ª£c H√≥a Gi·∫£i'],tags:['s·ª©c-kh·ªèe']},
          {id:'nguyen-nhan-su-co-may-moc',title:'Nguy√™n Nh√¢n S·ª± C·ªë M√°y M√≥c',subItems:['C√≥ Th·ªÉ Do T·ª´ Tr∆∞·ªùng Th∆∞·ª£ng ƒê·∫ø','T·∫•t Ngu·ªìn H√≥a Gi·∫£i','C√πng D∆∞·ª°ng ƒê·ªÉ B·ªÅn H∆°n'],tags:['h·ªá-th·ªëng']},
          {id:'benh-tat-do-tu-truong',title:'B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng',subItems:['M·ªçi B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng','Gi·ªØ Quy·ªÅn L√†m Ch·ªß','Tin T∆∞·ªüng & Th·ª±c H√†nh'],tags:['s·ª©c-kh·ªèe']}
        ]},
        '4':{ title:'B·∫£n Ch·∫•t Th∆∞·ª£ng ƒê·∫ø & C∆° Ch·∫ø V·∫≠n H√†nh', tags:['cƒÉn-b·∫£n','c∆°-ch·∫ø'], cards:[
          {id:'ban-chat-thuong-de',title:'B·∫£n Ch·∫•t Th∆∞·ª£ng ƒê·∫ø',subItems:[
            'Th∆∞·ª£ng ƒê·∫ø l√† Ngu·ªìn G·ªëc Duy Nh·∫•t','Kh√¥ng C√≥ Ph√¢n Chia Th·ª±c S·ª± (Thi·ªán/√Åc, Ph·∫≠t/Ma l√† vai di·ªÖn)','V·ª´a B√™n Trong V·ª´a B√™n Ngo√†i Con Ng∆∞·ªùi','T·ª± Chia M√¨nh Th√†nh C√°c Vai Di·ªÖn'],tags:['nh·∫•t-nguy√™n']},
          {id:'muc-dich-tao-dung',title:'M·ª•c ƒê√≠ch T·∫°o D·ª±ng',subItems:[
            '‚ÄúKh·∫£o‚Äù nghi·ªám & th·ª≠ th√°ch ch√≠nh m√¨nh (qua c√°c h√¨nh t∆∞·ªõng)','Gi√∫p con ng∆∞·ªùi nh·∫≠n ra Ch√¢n L√Ω & Gi√°c Ng·ªô','Ti·∫øn h√≥a & s√†ng l·ªçc','M·ªôt ‚Äútr√≤ ch∆°i‚Äù ‚Äì tr·∫£i nghi·ªám'],tags:['m·ª•c-ƒë√≠ch']},
          {id:'co-che-van-hanh',title:'C∆° Ch·∫ø V·∫≠n H√†nh',subItems:[
            '‚ÄúT·ª´ Tr∆∞·ªùng‚Äù: c√¥ng c·ª• ‚Äúƒë·∫©y‚Äù suy nghƒ©, c·∫£m x√∫c, th·ª≠ th√°ch','Kh√¥ng c√≥ ‚ÄúMa V∆∞∆°ng‚Äù ri√™ng bi·ªát','Lu·∫≠t Nh√¢n Qu·∫£ v·∫´n v·∫≠n h√†nh (nh∆∞ng c√≥ th·ªÉ chuy·ªÉn h√≥a)','‚Äúƒê·∫°i T·ª´ Bi‚Äù th·ªÉ hi·ªán qua c·∫£ ‚Äúthi·ªán‚Äù & ‚Äú√°c‚Äù (d√πng √°c di·ªát √°c)','‚ÄúL·ª´a B·ªãp‚Äù: t·∫°o t√¨nh hu·ªëng ƒë·ªÉ ki·ªÉm tra s·ª± s√°ng su·ªët'],tags:['c∆°-ch·∫ø']}
        ]},
        '5':{ title:'Con Ng∆∞·ªùi & Th∆∞·ª£ng ƒê·∫ø', tags:['b·∫£n-ng√£'], cards:[
          {id:'s1-c1',title:'Th∆∞·ª£ng ƒê·∫ø B√™n Trong',subItems:['M·ªói ng∆∞·ªùi mang trong m√¨nh m·ªôt ph·∫ßn Th∆∞·ª£ng ƒê·∫ø (T√°nh Bi·∫øt).','B·∫£n ch·∫•t th·∫≠t kh√¥ng b·ªã chi ph·ªëi b·ªüi suy nghƒ©/c·∫£m x√∫c/th√¢n x√°c.','S·ªëng thu·∫≠n theo ph·∫ßn Th∆∞·ª£ng ƒê·∫ø b√™n trong.'],tags:['t√°nh-bi·∫øt']},
          {id:'s1-c2',title:'Th∆∞·ª£ng ƒê·∫ø B√™n Ngo√†i',subItems:['Ng√†i l√† Ngu·ªìn C·ªôi & ‚Äúƒê·∫°i T·ª´ Tr∆∞·ªùng‚Äù bao tr√πm v·∫°n v·∫≠t.','M·ªçi hi·ªán t∆∞·ª£ng l√† bi·ªÉu hi·ªán c·ªßa Ng√†i.'],tags:['ƒë·∫°i-t·ª´-tr∆∞·ªùng']},
          {id:'s1-c3',title:'B·∫£n Ng√£',subItems:['B·ªã ƒë·ªìng h√≥a v·ªõi tham‚Äìs√¢n‚Äìsi t·∫°o ·∫£o ·∫£nh t√°ch bi·ªát & kh·ªï ƒëau.'],tags:['b·∫£n-ng√£']}
        ]},
        '6':{ title:'ƒê∆∞·ªùng Tu T·∫≠p (Theo Minh S∆∞)', tags:['th·ª±c-h√†nh'], cards:[
          {id:'s2-c1',title:'Nh·∫≠n Th·ª©c Nh·∫•t Nguy√™n',subItems:['Th·∫•y m·ªçi s·ª± ƒë·ªÅu l√† bi·ªÉu hi·ªán c·ªßa Th∆∞·ª£ng ƒê·∫ø.'],tags:['nh·∫•t-nguy√™n']},
          {id:'s2-c2',title:'S·ªëng V·ªõi T√°nh Bi·∫øt',subItems:['Quan s√°t suy nghƒ©/c·∫£m x√∫c m√† kh√¥ng b·ªã cu·ªën theo.'],tags:['t√°nh-bi·∫øt']}
        ]},
        '7':{ title:'·ª®ng D·ª•ng Th·ª±c T·∫ø', tags:['·ª©ng-d·ª•ng'], cards:[
          {id:'s3-c1',title:'ƒê·ªëi Di·ªán Kh√≥ KhƒÉn',subItems:['Xem kh√≥ khƒÉn l√† c∆° h·ªôi h·ªçc & tr∆∞·ªüng th√†nh.'],tags:['resilience']}
        ]}
      }
    }

    /* ========================= Utilities ========================= */
    const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
    const kv = (obj)=>Object.entries(obj);

    /* ========================= Contexts ========================= */
    const Ctx = createContext(null);

    function Provider({children}){
      const [theme, setTheme] = useState(()=>localStorage.getItem('theme')|| (matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light'));
      const [focus, setFocus] = useState(false);
      const [done, setDone] = useState(()=>{ try{ return JSON.parse(localStorage.getItem('done-map')||'{}')}catch{return{}} });
      const [notes, setNotes] = useState(()=>{ try{ return JSON.parse(localStorage.getItem('notes-map')||'{}')}catch{return{}} });
      const [q, setQ] = useState('');
      const [tag, setTag] = useState('');

      useEffect(()=>{ document.documentElement.setAttribute('data-theme', theme==='dark'?'dark':'light'); localStorage.setItem('theme', theme); },[theme]);
      useEffect(()=>{ try{localStorage.setItem('done-map', JSON.stringify(done))}catch{} },[done]);
      useEffect(()=>{ try{localStorage.setItem('notes-map', JSON.stringify(notes))}catch{} },[notes]);

      const value = useMemo(()=>({ theme,setTheme, focus,setFocus, done,setDone, notes,setNotes, q,setQ, tag,setTag }),[theme,focus,done,notes,q,tag]);
      return <Ctx.Provider value={value}>{children}</Ctx.Provider>;
    }

    /* ========================= Hooks ========================= */
    function useDebounce(fn, ms){ const t=useRef(); return useCallback((...args)=>{ clearTimeout(t.current); t.current=setTimeout(()=>fn(...args),ms); },[fn,ms]) }
    function useMedia(q){ const [m,setM]=useState(()=>matchMedia(q).matches); useEffect(()=>{const mq=matchMedia(q);const h=()=>setM(mq.matches); mq.addEventListener?.('change',h)||window.addEventListener('resize',h); return ()=>{mq.removeEventListener?.('change',h)||window.removeEventListener('resize',h)}},[q]); return m }

    /* ========================= Primitives ========================= */
    const Icon = ({path, className=''})=> <svg viewBox="0 0 24 24" aria-hidden="true" className={className}><path d={path} fill="currentColor"/></svg>;
    const CheckIcon = (p)=> <Icon {...p} path="M9 16.2l-3.5-3.5-1.4 1.4L9 19 20.3 7.7l-1.4-1.4z"/>;
    const ChevronIcon = (p)=> <Icon {...p} path="M8.12 9.29L12 13.17l3.88-3.88L17.3 10.7 12 16l-5.3-5.3z"/>;
    const SearchIcon = (p)=> <Icon {...p} path="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5z"/>;
    const NoteIcon = (p)=> <Icon {...p} path="M3 3h12a2 2 0 012 2v4h4v10a2 2 0 01-2 2H5a2 2 0 01-2-2V3zm14 6V5H5v14h14V9h-2z"/>;

    function Kbd({keys}){ return <span className="kbd">{keys}</span> }

    function ProgressBar(){
      const {done} = useContext(Ctx);
      const total = useMemo(()=> 1 + Object.values(DATA.sections).reduce((s,sec)=>s+sec.cards.length,0),[]);
      const count = Object.values(done).filter(Boolean).length;
      const pct = Math.round((count/total)*100);
      return (
        <div className="fixed top-0 left-0 right-0 h-1 z-50 bg-slate-200 dark:bg-slate-700" role="progressbar" aria-valuemin={0} aria-valuemax={100} aria-valuenow={pct}>
          <div className="h-full bg-brand-500" style={{width:`${pct}%`}} />
        </div>
      );
    }

    function Toast({text}){
      return (
        <div className="toast fixed top-3 left-1/2 -translate-x-1/2 z-[60] px-4 py-2 rounded-xl bg-slate-900 text-white/95 shadow-glow">
          {text}
        </div>
      )
    }

    /* ========================= Widgets ========================= */
    function Checkbox({checked,onToggle,label,id}){
      return (
        <button onClick={()=>onToggle?.(id)} aria-pressed={!!checked} className={`w-7 h-7 rounded-md border-2 flex items-center justify-center transition-colors ${checked? 'bg-emerald-500 border-emerald-500 text-white':'border-slate-400 dark:border-white/50 text-transparent'}`} title={checked? 'ƒê√£ ho√†n th√†nh':'ƒê√°nh d·∫•u ho√†n th√†nh'}>
          {checked && <CheckIcon className="w-4 h-4"/>}
          <span className="sr-only">{label||'ƒê√°nh d·∫•u'}</span>
        </button>
      )
    }

    function Card({card}){
      const {done,setDone, notes,setNotes} = useContext(Ctx);
      const [open, setOpen] = useState(false);
      const toggle = ()=> setDone(m=>({...m,[card.id]:!m[card.id]}));
      const note = notes[card.id]||'';
      const save = useDebounce((v)=> setNotes(m=>({...m,[card.id]:v})), 300);
      return (
        <article id={card.id} className="print-break rounded-xl overflow-hidden shadow-md bg-gradient-to-br from-brand-600 to-brand-700 text-white" tabIndex={0}>
          <header className="p-4 flex items-center gap-3 cursor-pointer" onClick={()=>setOpen(o=>!o)}>
            <Checkbox checked={!!done[card.id]} onToggle={toggle} id={card.id}/>
            <h4 className="text-lg font-semibold flex-1">{card.title}</h4>
            <ChevronIcon className={`w-6 h-6 transition-transform ${open?'rotate-180':''}`}/>
          </header>
          <div className={`grid transition-[grid-template-rows] duration-300 ${open?'grid-rows-[1fr]':'grid-rows-[0fr]'} bg-white/10`}> 
            <div className="overflow-hidden">
              {card.subItems && (
                <div className="px-4 pb-4 space-y-2">
                  {card.subItems.map((it,i)=>(<div key={i} className="bg-black/20 p-3 rounded-lg text-white/90">{it}</div>))}
                </div>
              )}
              <div className="px-4 pb-4">
                <label className="text-sm opacity-90 flex items-center gap-2 mb-1"><NoteIcon className="w-4 h-4"/>Ghi ch√∫ c·ªßa b·∫°n</label>
                <textarea defaultValue={note} onChange={(e)=>save(e.target.value)} placeholder="√ù t∆∞·ªüng, b√†i t·∫≠p, m·ªëc h√†nh ƒë·ªông‚Ä¶" className="w-full min-h-[80px] rounded-lg p-3 text-slate-900" />
              </div>
            </div>
          </div>
        </article>
      )
    }

    function Section({idx, sec}){
      const isDesktop = useMedia('(min-width: 768px)');
      const [open, setOpen] = useState(true);
      const {q, tag} = useContext(Ctx);

      const filteredCards = useMemo(()=>{
        const text = q.trim().toLowerCase();
        return sec.cards.filter(c=>{
          const inText = !text || (c.title+ ' ' + (c.subItems||[]).join(' ')).toLowerCase().includes(text);
          const inTag = !tag || (c.tags||[]).includes(tag);
          return inText && inTag;
        })
      },[q,tag,sec.cards]);

      return (
        <section className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl mb-6 overflow-hidden" aria-labelledby={`sec-${idx}`}> 
          <header className="p-4 flex justify-between items-center cursor-pointer select-none" onClick={()=> isDesktop && setOpen(o=>!o)}>
            <div className="flex items-center gap-4">
              <span className="font-display text-brand-600 text-lg">{idx}.</span>
              <h2 id={`sec-${idx}`} className="text-xl font-semibold">{sec.title}</h2>
            </div>
            <ChevronIcon className={`w-6 h-6 hidden md:block text-slate-500 transition-transform ${open?'rotate-180':''}`}/>
          </header>
          <div className={`${isDesktop? (open? 'block':'hidden') : 'block'}`}>
            <div className="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {filteredCards.length? filteredCards.map(c=> <Card key={c.id} card={c}/>) : (
                <p className="col-span-full text-sm opacity-70">Kh√¥ng c√≥ th·∫ª ph√π h·ª£p ƒëi·ªÅu ki·ªán l·ªçc.</p>
              )}
            </div>
          </div>
        </section>
      )
    }

    function CoreBlock(){
      const {done,setDone} = useContext(Ctx);
      return (
        <article className="rounded-xl shadow-md overflow-hidden bg-gradient-to-br from-fuchsia-600 to-purple-700 text-white">
          <header className="p-4 flex items-center gap-3">
            <Checkbox checked={!!done[DATA.core.id]} onToggle={()=>setDone(m=>({...m,[DATA.core.id]:!m[DATA.core.id]}))} id={DATA.core.id}/>
            <h3 className="text-xl font-semibold">{DATA.core.title}</h3>
          </header>
          <div className="px-4 pb-4">
            <ul className="list-disc list-inside space-y-2 text-white/90">
              {DATA.core.items.map((it,i)=>(<li key={i}>{it}</li>))}
            </ul>
          </div>
        </article>
      )
    }

    /* ========================= Command Bar & Sheets ========================= */
    function CommandBar(){
      const {theme,setTheme, focus,setFocus, q,setQ, tag,setTag, done} = useContext(Ctx);
      const [show, setShow] = useState(false);
      
      useEffect(()=>{
        const onKey = (e)=>{
          if (e.key==='k' && (e.ctrlKey||e.metaKey)) { e.preventDefault(); setShow(s=>!s); }
          if (e.key==='/' && !e.metaKey && !e.ctrlKey){ e.preventDefault(); setShow(true); }
          if (e.key==='p' && (e.ctrlKey||e.metaKey)){ window.print(); }
        };
        addEventListener('keydown', onKey);
        return ()=>removeEventListener('keydown', onKey);
      },[]);
      
      const tags = useMemo(()=>{
        const s = new Set();
        s.add(''); // All
        kv(DATA.sections).forEach(([k,sec])=> sec.cards.forEach(c=> (c.tags||[]).forEach(t=>s.add(t))));
        return [...s];
      },[]);

      return (
        <div className="cmdbar fixed top-2 left-0 right-0 z-40">
          <div className="mx-auto max-w-6xl px-3">
            <div className="backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-slate-900/60 bg-white/80 dark:bg-slate-900/70 rounded-xl shadow border border-black/5 dark:border-white/10 px-2 py-1.5 flex items-center gap-1">
              {/* Search */}
              <div className="flex-1 flex items-center gap-2">
                <SearchIcon className="w-5 h-5 text-slate-500"/>
                <input value={q} onChange={(e)=>setQ(e.target.value)} placeholder="T√¨m nhanh (ti√™u ƒë·ªÅ, n·ªôi dung)‚Ä¶" className="w-full bg-transparent outline-none text-sm" aria-label="T√¨m ki·∫øm"/>
              </div>
              {/* Tag filter */}
              <select value={tag} onChange={(e)=>setTag(e.target.value)} className="text-sm rounded-lg bg-slate-100 dark:bg-slate-800 px-2 py-1 border border-slate-200 dark:border-slate-700">
                {tags.map(t=> <option key={t} value={t}>{t?`#${t}`:'T·∫•t c·∫£ th·∫ª'}</option>)}
              </select>
              {/* Progress */}
              <span className="ml-1 text-[11px] px-1.5 py-0.5 rounded-full bg-brand-600 text-white">{Math.round((Object.values(done).filter(Boolean).length / (1+kv(DATA.sections).reduce((s,[,sec])=>s+sec.cards.length,0)) )*100)}%</span>
              {/* Theme */}
              <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" title="ƒê·ªïi ch·ªß ƒë·ªÅ" onClick={()=> setTheme(t=> t==='light'?'dark':(t==='dark'?'sepia':'light'))}>Ch·ªß ƒë·ªÅ</button>
              {/* Focus */}
              <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" title="Ch·∫ø ƒë·ªô t·∫≠p trung" onClick={()=>setFocus(f=>!f)}>{"T·∫≠p trung"}</button>
              {/* More... */}
              <div className="relative">
                <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" onClick={()=>setShow(s=>!s)} aria-expanded={show}>‚ãØ</button>
                <div className={`absolute right-0 mt-1 min-w-[200px] rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow ${show? 'opacity-100':'opacity-0 pointer-events-none'} transition-opacity`}>
                  <button className="w-full text-left px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-700" onClick={()=>{window.print(); setShow(false);}}>In / PDF</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      )
    }

    function BottomNav(){
      const [open, setOpen] = useState(false);
      const ref = useRef(null);
      useEffect(()=>{
        const click = (e)=>{ if (ref.current && !ref.current.contains(e.target)) setOpen(false); };
        document.addEventListener('mousedown', click);
        return ()=>document.removeEventListener('mousedown', click);
      }, []);
      return (
        <nav className="bottom-nav fixed bottom-0 left-0 right-0 z-30 p-2 flex justify-center font-display uppercase">
          <div className="flex gap-2">
            <a href="https://thiensutinhquang.github.io/home/" target="_blank" rel="noopener" className="px-4 h-11 rounded-xl bg-black text-white inline-flex items-center shadow-glow">Trang ch·ªß</a>
            <a href="https://thiensutinhquang.github.io/PlayMusic/" target="_blank" rel="noopener" className="px-4 h-11 rounded-xl bg-gradient-to-r from-pink-600 to-purple-600 text-white inline-flex items-center shadow-glow">Play Nh·∫°c</a>
            <div className={`group relative ${open ? 'overflow-visible' : ''}`} ref={ref}>
              <button className="px-4 h-11 rounded-xl bg-black/90 text-white inline-flex items-center shadow-glow" onClick={()=>setOpen(o=>!o)}>N·ªÅn t·∫£ng</button>
              <div className={`absolute left-1/2 -translate-x-1/2 bottom-[52px] flex gap-2 bg-black/80 border border-white/30 rounded-xl p-2 backdrop-blur-md ${open? 'opacity-100':'opacity-0 pointer-events-none'} transition-opacity`}>
                <a href="https://www.youtube.com/@ThiensuTinhQuang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="YouTube" src="https://upload.wikimedia.org/wikipedia/commons/0/09/YouTube_full-color_icon_%282017%29.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/ff0000/ffffff?text=YT'}}/></a>
                <a href="https://www.tiktok.com/@minhsutinhquang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="TikTok" src="https://static-00.iconduck.com/assets.00/tiktok-icon-2048x2048-15w2g25h.png" onError={(e)=>{e.target.src='https://placehold.co/28x28/ffffff/000?text=TT'}}/></a>
                <a href="https://www.facebook.com/groups/minhsutinhquang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Facebook" src="https://upload.wikimedia.org/wikipedia/commons/1/1b/Facebook_icon.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/1877f2/fff?text=FB'}}/></a>
                <a href="https://t.me/Giaoly_phap_don_ngo" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Telegram" src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/229ed9/fff?text=TG'}}/></a>
                <a href="https://zalo.me/g/dukrae245" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Zalo" src="https://upload.wikimedia.org/wikipedia/commons/9/91/Icon_of_Zalo.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/0068ff/fff?text=ZL'}}/></a>
              </div>
            </div>
          </div>
        </nav>
      )
    }
    
    /* ========================= App ========================= */
    function App(){
      const {focus} = useContext(Ctx);
      const [loading, setLoading] = useState(true);
      useEffect(()=>{ const t=setTimeout(()=>setLoading(false), 300); return ()=>clearTimeout(t) },[]);
      if (loading) return (
        <div className="max-w-6xl mx-auto mt-24 space-y-6 p-4" aria-busy>
          <div className="shimmer rounded-xl h-28"></div>
          <div className="shimmer rounded-xl h-20"></div>
          <div className="shimmer rounded-xl h-20"></div>
          <div className="shimmer rounded-xl h-20"></div>
        </div>
      );
      return (
        <div className={focus? 'reduce-motion':''}>
          <ProgressBar/>
          <CommandBar/>

          <main className={`max-w-6xl mx-auto pt-16 px-4 ${focus? 'opacity-95':''}`}>
            <CoreBlock/>
            {kv(DATA.sections).map(([id, sec])=> <Section key={id} idx={id} sec={sec}/>) }

            <aside className="bg-white dark:bg-slate-800 rounded-xl shadow p-6 my-8">
              <h2 className="text-2xl font-semibold mb-3">H∆∞·ªõng d·∫´n nhanh</h2>
              <ul className="list-disc list-inside space-y-2 text-sm">
                <li>T√¨m ki·∫øm t·ª©c th·ªùi <Kbd keys="Ctrl/‚åò + /"/> ho·∫∑c g√µ thanh t√¨m ki·∫øm.</li>
                <li>M·ªü h·ªôp l·ªánh <Kbd keys="Ctrl/‚åò + K"/> ƒë·ªÉ thao t√°c nhanh; In/PDF <Kbd keys="Ctrl/‚åò + P"/>.</li>
                <li>ƒê·ªïi ch·ªß ƒë·ªÅ (Light/Dark/Sepia), b·∫≠t <em>T·∫≠p trung</em> ƒë·ªÉ gi·∫£m nhi·ªÖu, l∆∞u ti·∫øn ƒë·ªô t·ª± ƒë·ªông.</li>
                <li>Ghi ch√∫ ri√™ng tr√™n t·ª´ng th·∫ª ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông v√†o thi·∫øt b·ªã c·ªßa b·∫°n.</li>
              </ul>
            </aside>
          </main>

          <BottomNav/>
        </div>
      )
    }

    const Root = () => (
      <Provider>
        <App/>
      </Provider>
    );

    ReactDOM.createRoot(document.getElementById('root')).render(<Root/>);
  </script>
</body>
</html>
```

File contents for `index.html`:
```html
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>S∆° ƒë·ªì h·ªçc h·ª£p nh·∫•t ‚Äì Chuy√™n gia ƒë·ª©ng ƒë·∫ßu üåê</title>
  <meta name="description" content="H·ªá th·ªëng s∆° ƒë·ªì h·ªçc h·ª£p nh·∫•t ‚Äì tr·ª±c quan, si√™u m∆∞·ª£t, th√¢n thi·ªán di ƒë·ªông, theo d√µi ti·∫øn ƒë·ªô, t√¨m ki·∫øm t·ª©c th·ªùi, in/ghi ch√∫, m·ªôt file duy nh·∫•t." />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0b0f19" />
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Be+Vietnam+Pro:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com/3.4.1"></script>
  <script>
    tailwind.config = {
      darkMode: ['class', '[data-theme="dark"]'],
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', 'sans-serif'],
            display: ['Be Vietnam Pro','Inter','system-ui']
          },
          colors: {
            brand: {
              50:'#eef2ff',100:'#e0e7ff',200:'#c7d2fe',300:'#a5b4fc',400:'#818cf8',500:'#6366f1',600:'#4f46e5',700:'#4338ca',800:'#3730a3',900:'#312e81'
            }
          },
          boxShadow: {
            glow: '0 0 0 1px rgba(99,102,241,.2), 0 10px 30px -10px rgba(99,102,241,.6)'
          }
        }
      }
    }
  </script>
  <style>
    :root { --glow-red: rgba(255, 31, 113, 0.7); --glow-blue: rgba(0,191,255,.7); }
    html, body { height: 100%; }
    body { font-family: var(--tw-font-sans, 'Inter', system-ui); }
    main { padding-bottom: 96px; }
    .reduce-motion * { transition: none !important; animation: none !important; }
    @media (prefers-reduced-motion: reduce){ body {scroll-behavior:auto;} }
    .kbd { @apply inline-flex items-center justify-center rounded-md border border-gray-300 dark:border-white/20 px-1.5 text-[11px] h-5 leading-none; }
    .scrollbar-thin { scrollbar-width: thin; }
    .scrollbar-thin::-webkit-scrollbar{height:8px;width:8px}
    .scrollbar-thin::-webkit-scrollbar-thumb{background:rgba(100,116,139,.5);border-radius:8px}
    .shimmer{position:relative;overflow:hidden;background:linear-gradient(90deg,#e5e7eb 25%,#f3f4f6 37%,#e5e7eb 63%);background-size:400% 100%;animation:shimmer 1.6s infinite}
    @keyframes shimmer {0%{background-position:100% 0}100%{background-position:0 0}}
    /* Print */
    @media print{
      header, .cmdbar, .bottom-nav, .sheet-root, .toast { display:none !important }
      .print-break{ break-inside: avoid; page-break-inside: avoid }
      body { background:#fff; color:#111 }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 selection:bg-brand-500/30">
  <div id="root"></div>

  <!-- React 18 UMD (production) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <!-- Babel for inline JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const {useState,useEffect,useMemo,useRef,useCallback,createContext,useContext} = React;

    /* ========================= Data (domain model) ========================= */
    const DATA = {
      core: {
        id:'core-teaching',
        title:'T·∫•t C·∫£ T·ª´ M·ªôt ‚Äì Nh·∫•t Nguy√™n (Th∆∞·ª£ng ƒê·∫ø)',
        items:[
          'Th∆∞·ª£ng ƒê·∫ø l√† Ngu·ªìn G·ªëc Duy Nh·∫•t c·ªßa v·∫°n v·∫≠t, kh√¥ng c√≥ g√¨ kh√°c ngo√†i Ng√†i.',
          'Ng√†i t·ª± ph√¢n chia th√†nh v√¥ s·ªë h√¨nh t∆∞·ªõng ƒë·ªÉ tr·∫£i nghi·ªám v√† th·∫•u hi·ªÉu ch√≠nh m√¨nh.',
          'B·∫£n ch·∫•t c·ªßa Th∆∞·ª£ng ƒê·∫ø l√† s√°ng su·ªët, v√¥ h·∫°n, v∆∞·ª£t kh√¥ng gian & th·ªùi gian.',
          'M·ª•c ƒë√≠ch s·ªëng: nh·∫≠n ra B·∫£n Th·ªÉ b√™n trong ƒë·ªÉ tr·ªü v·ªÅ Nh·∫•t Nguy√™n.'
        ],
        tags:['cƒÉn-b·∫£n','nh·∫•t-nguy√™n']
      },
      sections: {
        '1':{ title:'N√¢ng Cao Tinh Th·∫ßn & S·ª©c Kh·ªèe', tags:['·ª©ng-d·ª•ng','nƒÉng-l∆∞·ª£ng'], cards:[
          {id:'suc-manh-tho-ca',title:'S·ª©c M·∫°nh Th∆° Ca & √Çm Nh·∫°c',subItems:['ƒê·ªçc, H√°t, Nghe Th∆° Ca T√≠ch C·ª±c'],tags:['√¢m-nh·∫°c','t√≠ch-c·ª±c']},
          {id:'song-co-muc-dich',title:'S·ªëng C√≥ M·ª•c ƒê√≠ch',subItems:['L·∫≠p K·∫ø Ho·∫°ch, Theo ƒêu·ªïi ƒêam M√™','Tr√°nh M·∫•t Ph∆∞∆°ng H∆∞·ªõng, Ti√™u C·ª±c'],tags:['m·ª•c-ti√™u']}
        ]},
        '2':{ title:'B·∫£o V·ªá T√¢m Tr√≠ & Tr√≠ Tu·ªá', tags:['tr√≠-tu·ªá'], cards:[
          {id:'giu-tri-tue-sang-suot',title:'Gi·ªØ Tr√≠ Tu·ªá S√°ng Su·ªët',subItems:[
            'C·∫£nh Gi√°c V·ªõi L√≤ng Tham','Ph√¢n T√≠ch, Nh·∫≠n Di·ªán C·∫°m B·∫´y','Chi·∫øn Th·∫Øng T√¢m X·∫•u √Åc','Nh·∫≠n Di·ªán Ph·∫≠t T√≠nh B√™n Trong','T·ª´ Ch·ªëi X√∫i Gi·ª•c Ti√™u C·ª±c','Chuy·ªÉn H√≥a Suy Nghƒ© Ti√™u C·ª±c'],tags:['nh·∫≠n-di·ªán','t·ªânh-th·ª©c']},
          {id:'de-phong-tam',title:'ƒê·ªÅ Ph√≤ng T√¢m & Th∆∞·ª£ng ƒê·∫ø B√™n Trong',subItems:[
            'T·ªânh Gi√°c V·ªõi Suy Nghƒ© Ti√™u C·ª±c','Ch·ªçn L·ªçc Suy Nghƒ© T√≠ch C·ª±c','H√≥a Gi·∫£i ‚ÄúMa Qu·ª∑‚Äù ·∫¢o ·∫¢nh','Nh·∫≠n Ra ·∫¢o ·∫¢nh Do Th∆∞·ª£ng ƒê·∫ø','Kh√¥ng S·ª£ H√£i, ·ª®ng X·ª≠ T√≠ch C·ª±c','Ni·ªám Ch√∫ & T·∫≠p Th·ªÉ D·ª•c H√≥a Gi·∫£i'],tags:['t·ªânh-gi√°c']},
          {id:'than-trong-loi-noi',title:'Th·∫≠n Tr·ªçng Trong L·ªùi N√≥i',subItems:['Hi·ªÉu R√µ Tr∆∞·ªõc Khi N√≥i/Vi·∫øt','Th·∫≠n Tr·ªçng B√≠ M·∫≠t Ri√™ng T∆∞','S·ªëng T·ªânh Th·ª©c'],tags:['giao-ti·∫øp']}
        ]},
        '3':{ title:'Hi·ªÉu Bi·∫øt V≈© Tr·ª• & B·∫£n Ch·∫•t', tags:['tri·∫øt-h·ªçc'], cards:[
          {id:'nguon-goc-su-song',title:'Ngu·ªìn G·ªëc S·ª± S·ªëng',subItems:['S·ª± S·ªëng Kh·∫Øp V≈© Tr·ª•','√ù Th·ª©c, B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng','Thi·ªÅn ƒê·ªãnh ƒê·ªÉ Th·∫•u Hi·ªÉu'],tags:['v≈©-tr·ª•']},
          {id:'an-nhien-truoc-thi-phi',title:'An Nhi√™n Tr∆∞·ªõc Th·ªã Phi',subItems:['Kh√¥ng B·∫≠n T√¢m L·ªùi V·ª• Kh√¥ng','Th·∫•u Hi·ªÉu Ng∆∞·ªùi Kh√°c'],tags:['an-nhi√™n']},
          {id:'nguon-goc-virus',title:'Ngu·ªìn G·ªëc Virus, Vi Khu·∫©n',subItems:['Do Th∆∞·ª£ng ƒê·∫ø T·∫°o Ra & ƒêi·ªÅu Khi·ªÉn','B·ªánh Do T·ª´ Tr∆∞·ªùng √Åc Tr∆∞·ª£c','Ng·ªô Ra ƒê·ªÉ ƒê∆∞·ª£c H√≥a Gi·∫£i'],tags:['s·ª©c-kh·ªèe']},
          {id:'nguyen-nhan-su-co-may-moc',title:'Nguy√™n Nh√¢n S·ª± C·ªë M√°y M√≥c',subItems:['C√≥ Th·ªÉ Do T·ª´ Tr∆∞·ªùng Th∆∞·ª£ng ƒê·∫ø','T·∫•t Ngu·ªìn H√≥a Gi·∫£i','C√πng D∆∞·ª°ng ƒê·ªÉ B·ªÅn H∆°n'],tags:['h·ªá-th·ªëng']},
          {id:'benh-tat-do-tu-truong',title:'B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng',subItems:['M·ªçi B·ªánh T·∫≠t Do T·ª´ Tr∆∞·ªùng','Gi·ªØ Quy·ªÅn L√†m Ch·ªß','Tin T∆∞·ªüng & Th·ª±c H√†nh'],tags:['s·ª©c-kh·ªèe']}
        ]},
        '4':{ title:'B·∫£n Ch·∫•t Th∆∞·ª£ng ƒê·∫ø & C∆° Ch·∫ø V·∫≠n H√†nh', tags:['cƒÉn-b·∫£n','c∆°-ch·∫ø'], cards:[
          {id:'ban-chat-thuong-de',title:'B·∫£n Ch·∫•t Th∆∞·ª£ng ƒê·∫ø',subItems:[
            'Th∆∞·ª£ng ƒê·∫ø l√† Ngu·ªìn G·ªëc Duy Nh·∫•t','Kh√¥ng C√≥ Ph√¢n Chia Th·ª±c S·ª± (Thi·ªán/√Åc, Ph·∫≠t/Ma l√† vai di·ªÖn)','V·ª´a B√™n Trong V·ª´a B√™n Ngo√†i Con Ng∆∞·ªùi','T·ª± Chia M√¨nh Th√†nh C√°c Vai Di·ªÖn'],tags:['nh·∫•t-nguy√™n']},
          {id:'muc-dich-tao-dung',title:'M·ª•c ƒê√≠ch T·∫°o D·ª±ng',subItems:[
            '‚ÄúKh·∫£o‚Äù nghi·ªám & th·ª≠ th√°ch ch√≠nh m√¨nh (qua c√°c h√¨nh t∆∞·ªõng)','Gi√∫p con ng∆∞·ªùi nh·∫≠n ra Ch√¢n L√Ω & Gi√°c Ng·ªô','Ti·∫øn h√≥a & s√†ng l·ªçc','M·ªôt ‚Äútr√≤ ch∆°i‚Äù ‚Äì tr·∫£i nghi·ªám'],tags:['m·ª•c-ƒë√≠ch']},
          {id:'co-che-van-hanh',title:'C∆° Ch·∫ø V·∫≠n H√†nh',subItems:[
            '‚ÄúT·ª´ Tr∆∞·ªùng‚Äù: c√¥ng c·ª• ‚Äúƒë·∫©y‚Äù suy nghƒ©, c·∫£m x√∫c, th·ª≠ th√°ch','Kh√¥ng c√≥ ‚ÄúMa V∆∞∆°ng‚Äù ri√™ng bi·ªát','Lu·∫≠t Nh√¢n Qu·∫£ v·∫´n v·∫≠n h√†nh (nh∆∞ng c√≥ th·ªÉ chuy·ªÉn h√≥a)','‚Äúƒê·∫°i T·ª´ Bi‚Äù th·ªÉ hi·ªán qua c·∫£ ‚Äúthi·ªán‚Äù & ‚Äú√°c‚Äù (d√πng √°c di·ªát √°c)','‚ÄúL·ª´a B·ªãp‚Äù: t·∫°o t√¨nh hu·ªëng ƒë·ªÉ ki·ªÉm tra s·ª± s√°ng su·ªët'],tags:['c∆°-ch·∫ø']}
        ]},
        '5':{ title:'Con Ng∆∞·ªùi & Th∆∞·ª£ng ƒê·∫ø', tags:['b·∫£n-ng√£'], cards:[
          {id:'s1-c1',title:'Th∆∞·ª£ng ƒê·∫ø B√™n Trong',subItems:['M·ªói ng∆∞·ªùi mang trong m√¨nh m·ªôt ph·∫ßn Th∆∞·ª£ng ƒê·∫ø (T√°nh Bi·∫øt).','B·∫£n ch·∫•t th·∫≠t kh√¥ng b·ªã chi ph·ªëi b·ªüi suy nghƒ©/c·∫£m x√∫c/th√¢n x√°c.','S·ªëng thu·∫≠n theo ph·∫ßn Th∆∞·ª£ng ƒê·∫ø b√™n trong.'],tags:['t√°nh-bi·∫øt']},
          {id:'s1-c2',title:'Th∆∞·ª£ng ƒê·∫ø B√™n Ngo√†i',subItems:['Ng√†i l√† Ngu·ªìn C·ªôi & ‚Äúƒê·∫°i T·ª´ Tr∆∞·ªùng‚Äù bao tr√πm v·∫°n v·∫≠t.','M·ªçi hi·ªán t∆∞·ª£ng l√† bi·ªÉu hi·ªán c·ªßa Ng√†i.'],tags:['ƒë·∫°i-t·ª´-tr∆∞·ªùng']},
          {id:'s1-c3',title:'B·∫£n Ng√£',subItems:['B·ªã ƒë·ªìng h√≥a v·ªõi tham‚Äìs√¢n‚Äìsi t·∫°o ·∫£o ·∫£nh t√°ch bi·ªát & kh·ªï ƒëau.'],tags:['b·∫£n-ng√£']}
        ]},
        '6':{ title:'ƒê∆∞·ªùng Tu T·∫≠p (Theo Minh S∆∞)', tags:['th·ª±c-h√†nh'], cards:[
          {id:'s2-c1',title:'Nh·∫≠n Th·ª©c Nh·∫•t Nguy√™n',subItems:['Th·∫•y m·ªçi s·ª± ƒë·ªÅu l√† bi·ªÉu hi·ªán c·ªßa Th∆∞·ª£ng ƒê·∫ø.'],tags:['nh·∫•t-nguy√™n']},
          {id:'s2-c2',title:'S·ªëng V·ªõi T√°nh Bi·∫øt',subItems:['Quan s√°t suy nghƒ©/c·∫£m x√∫c m√† kh√¥ng b·ªã cu·ªën theo.'],tags:['t√°nh-bi·∫øt']}
        ]},
        '7':{ title:'·ª®ng D·ª•ng Th·ª±c T·∫ø', tags:['·ª©ng-d·ª•ng'], cards:[
          {id:'s3-c1',title:'ƒê·ªëi Di·ªán Kh√≥ KhƒÉn',subItems:['Xem kh√≥ khƒÉn l√† c∆° h·ªôi h·ªçc & tr∆∞·ªüng th√†nh.'],tags:['resilience']}
        ]}
      }
    }

    /* ========================= Utilities ========================= */
    const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
    const kv = (obj)=>Object.entries(obj);

    /* ========================= Contexts ========================= */
    const Ctx = createContext(null);

    function Provider({children}){
      const [theme, setTheme] = useState(()=>localStorage.getItem('theme')|| (matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light'));
      const [focus, setFocus] = useState(false);
      const [done, setDone] = useState(()=>{ try{ return JSON.parse(localStorage.getItem('done-map')||'{}')}catch{return{}} });
      const [notes, setNotes] = useState(()=>{ try{ return JSON.parse(localStorage.getItem('notes-map')||'{}')}catch{return{}} });
      const [q, setQ] = useState('');
      const [tag, setTag] = useState('');

      useEffect(()=>{ document.documentElement.setAttribute('data-theme', theme==='dark'?'dark':'light'); localStorage.setItem('theme', theme); },[theme]);
      useEffect(()=>{ try{localStorage.setItem('done-map', JSON.stringify(done))}catch{} },[done]);
      useEffect(()=>{ try{localStorage.setItem('notes-map', JSON.stringify(notes))}catch{} },[notes]);

      const value = useMemo(()=>({ theme,setTheme, focus,setFocus, done,setDone, notes,setNotes, q,setQ, tag,setTag }),[theme,focus,done,notes,q,tag]);
      return <Ctx.Provider value={value}>{children}</Ctx.Provider>;
    }

    /* ========================= Hooks ========================= */
    function useDebounce(fn, ms){ const t=useRef(); return useCallback((...args)=>{ clearTimeout(t.current); t.current=setTimeout(()=>fn(...args),ms); },[fn,ms]) }
    function useMedia(q){ const [m,setM]=useState(()=>matchMedia(q).matches); useEffect(()=>{const mq=matchMedia(q);const h=()=>setM(mq.matches); mq.addEventListener?.('change',h)||window.addEventListener('resize',h); return ()=>{mq.removeEventListener?.('change',h)||window.removeEventListener('resize',h)}},[q]); return m }

    /* ========================= Primitives ========================= */
    const Icon = ({path, className=''})=> <svg viewBox="0 0 24 24" aria-hidden="true" className={className}><path d={path} fill="currentColor"/></svg>;
    const CheckIcon = (p)=> <Icon {...p} path="M9 16.2l-3.5-3.5-1.4 1.4L9 19 20.3 7.7l-1.4-1.4z"/>;
    const ChevronIcon = (p)=> <Icon {...p} path="M8.12 9.29L12 13.17l3.88-3.88L17.3 10.7 12 16l-5.3-5.3z"/>;
    const SearchIcon = (p)=> <Icon {...p} path="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5z"/>;
    const NoteIcon = (p)=> <Icon {...p} path="M3 3h12a2 2 0 012 2v4h4v10a2 2 0 01-2 2H5a2 2 0 01-2-2V3zm14 6V5H5v14h14V9h-2z"/>;

    function Kbd({keys}){ return <span className="kbd">{keys}</span> }

    function ProgressBar(){
      const {done} = useContext(Ctx);
      const total = useMemo(()=> 1 + Object.values(DATA.sections).reduce((s,sec)=>s+sec.cards.length,0),[]);
      const count = Object.values(done).filter(Boolean).length;
      const pct = Math.round((count/total)*100);
      return (
        <div className="fixed top-0 left-0 right-0 h-1 z-50 bg-slate-200 dark:bg-slate-700" role="progressbar" aria-valuemin={0} aria-valuemax={100} aria-valuenow={pct}>
          <div className="h-full bg-brand-500" style={{width:`${pct}%`}} />
        </div>
      );
    }

    /* ========================= Widgets ========================= */
    function Checkbox({checked,onToggle,label,id}){
      return (
        <button onClick={()=>onToggle?.(id)} aria-pressed={!!checked} className={`w-7 h-7 rounded-md border-2 flex items-center justify-center transition-colors ${checked? 'bg-emerald-500 border-emerald-500 text-white':'border-slate-400 dark:border-white/50 text-transparent'}`} title={checked? 'ƒê√£ ho√†n th√†nh':'ƒê√°nh d·∫•u ho√†n th√†nh'}>
          {checked && <CheckIcon className="w-4 h-4"/>}
          <span className="sr-only">{label||'ƒê√°nh d·∫•u'}</span>
        </button>
      )
    }

    function Card({card}){
      const {done,setDone, notes,setNotes} = useContext(Ctx);
      const [open, setOpen] = useState(false);
      const toggle = ()=> setDone(m=>({...m,[card.id]:!m[card.id]}));
      const note = notes[card.id]||'';
      const save = useDebounce((v)=> setNotes(m=>({...m,[card.id]:v})), 300);
      return (
        <article id={card.id} className="print-break rounded-xl overflow-hidden shadow-md bg-gradient-to-br from-brand-600 to-brand-700 text-white" tabIndex={0}>
          <header className="p-4 flex items-center gap-3 cursor-pointer" onClick={()=>setOpen(o=>!o)}>
            <Checkbox checked={!!done[card.id]} onToggle={toggle} id={card.id}/>
            <h4 className="text-lg font-semibold flex-1">{card.title}</h4>
            <ChevronIcon className={`w-6 h-6 transition-transform ${open?'rotate-180':''}`}/>
          </header>
          <div className={`grid transition-[grid-template-rows] duration-300 ${open?'grid-rows-[1fr]':'grid-rows-[0fr]'} bg-white/10`}> 
            <div className="overflow-hidden">
              {card.subItems && (
                <div className="px-4 pb-4 space-y-2">
                  {card.subItems.map((it,i)=>(<div key={i} className="bg-black/20 p-3 rounded-lg text-white/90">{it}</div>))}
                </div>
              )}
              <div className="px-4 pb-4">
                <label className="text-sm opacity-90 flex items-center gap-2 mb-1"><NoteIcon className="w-4 h-4"/>Ghi ch√∫ c·ªßa b·∫°n</label>
                <textarea defaultValue={note} onChange={(e)=>save(e.target.value)} placeholder="√ù t∆∞·ªüng, b√†i t·∫≠p, m·ªëc h√†nh ƒë·ªông‚Ä¶" className="w-full min-h-[80px] rounded-lg p-3 text-slate-900" />
              </div>
            </div>
          </div>
        </article>
      )
    }

    function Section({idx, sec}){
      const isDesktop = useMedia('(min-width: 768px)');
      const [open, setOpen] = useState(true);
      const {q, tag} = useContext(Ctx);

      const filteredCards = useMemo(()=>{
        const text = q.trim().toLowerCase();
        return sec.cards.filter(c=>{
          const inText = !text || (c.title+ ' ' + (c.subItems||[]).join(' ')).toLowerCase().includes(text);
          const inTag = !tag || (c.tags||[]).includes(tag);
          return inText && inTag;
        })
      },[q,tag,sec.cards]);

      return (
        <section className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl mb-6 overflow-hidden" aria-labelledby={`sec-${idx}`}> 
          <header className="p-4 flex justify-between items-center cursor-pointer select-none" onClick={()=> isDesktop && setOpen(o=>!o)}>
            <div className="flex items-center gap-4">
              <span className="font-display text-brand-600 text-lg">{idx}.</span>
              <h2 id={`sec-${idx}`} className="text-xl font-semibold">{sec.title}</h2>
            </div>
            <ChevronIcon className={`w-6 h-6 hidden md:block text-slate-500 transition-transform ${open?'rotate-180':''}`}/>
          </header>
          <div className={`${isDesktop? (open? 'block':'hidden') : 'block'}`}>
            <div className="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {filteredCards.length? filteredCards.map(c=> <Card key={c.id} card={c}/>) : (
                <p className="col-span-full text-sm opacity-70">Kh√¥ng c√≥ th·∫ª ph√π h·ª£p ƒëi·ªÅu ki·ªán l·ªçc.</p>
              )}
            </div>
          </div>
        </section>
      )
    }

    function CoreBlock(){
      const {done,setDone} = useContext(Ctx);
      return (
        <article className="rounded-xl shadow-md overflow-hidden bg-gradient-to-br from-fuchsia-600 to-purple-700 text-white">
          <header className="p-4 flex items-center gap-3">
            <Checkbox checked={!!done[DATA.core.id]} onToggle={()=>setDone(m=>({...m,[DATA.core.id]:!m[DATA.core.id]}))} id={DATA.core.id}/>
            <h3 className="text-xl font-semibold">{DATA.core.title}</h3>
          </header>
          <div className="px-4 pb-4">
            <ul className="list-disc list-inside space-y-2 text-white/90">
              {DATA.core.items.map((it,i)=>(<li key={i}>{it}</li>))}
            </ul>
          </div>
        </article>
      )
    }

    /* ========================= Command Bar & Sheets ========================= */
    function CommandBar(){
      const {theme,setTheme, focus,setFocus, q,setQ, tag,setTag, done} = useContext(Ctx);
      const [show, setShow] = useState(false);

      useEffect(()=>{
        const onKey = (e)=>{
          if (e.key==='k' && (e.ctrlKey||e.metaKey)) { e.preventDefault(); setShow(s=>!s); }
          if (e.key==='/' && !e.metaKey && !e.ctrlKey){ e.preventDefault(); setShow(true); }
          if (e.key==='p' && (e.ctrlKey||e.metaKey)){ window.print(); }
        };
        addEventListener('keydown', onKey);
        return ()=>removeEventListener('keydown', onKey);
      },[]);
      
      const tags = useMemo(()=>{
        const s = new Set();
        s.add(''); // All
        kv(DATA.sections).forEach(([k,sec])=> sec.cards.forEach(c=> (c.tags||[]).forEach(t=>s.add(t))));
        return [...s];
      },[]);

      return (
        <div className="cmdbar fixed top-2 left-0 right-0 z-40">
          <div className="mx-auto max-w-6xl px-3">
            <div className="backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-slate-900/60 bg-white/80 dark:bg-slate-900/70 rounded-xl shadow border border-black/5 dark:border-white/10 px-2 py-1.5 flex items-center gap-1">
              {/* Search */}
              <div className="flex-1 flex items-center gap-2">
                <SearchIcon className="w-5 h-5 text-slate-500"/>
                <input value={q} onChange={(e)=>setQ(e.target.value)} placeholder="T√¨m nhanh (ti√™u ƒë·ªÅ, n·ªôi dung)‚Ä¶" className="w-full bg-transparent outline-none text-sm" aria-label="T√¨m ki·∫øm"/>
              </div>
              {/* Tag filter */}
              <select value={tag} onChange={(e)=>setTag(e.target.value)} className="text-sm rounded-lg bg-slate-100 dark:bg-slate-800 px-2 py-1 border border-slate-200 dark:border-slate-700">
                {tags.map(t=> <option key={t} value={t}>{t?`#${t}`:'T·∫•t c·∫£ th·∫ª'}</option>)}
              </select>
              {/* Progress */}
              <span className="ml-1 text-[11px] px-1.5 py-0.5 rounded-full bg-brand-600 text-white">{Math.round((Object.values(done).filter(Boolean).length / (1+kv(DATA.sections).reduce((s,[,sec])=>s+sec.cards.length,0)) )*100)}%</span>
              {/* Theme */}
              <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" title="ƒê·ªïi ch·ªß ƒë·ªÅ" onClick={()=> setTheme(t=> t==='light'?'dark':(t==='dark'?'sepia':'light'))}>Ch·ªß ƒë·ªÅ</button>
              {/* Focus */}
              <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" title="Ch·∫ø ƒë·ªô t·∫≠p trung" onClick={()=>setFocus(f=>!f)}>{"T·∫≠p trung"}</button>
              {/* More... */}
              <div className="relative">
                <button className="px-2 py-1 rounded-lg hover:bg-black/5 dark:hover:bg-white/10" onClick={()=>setShow(s=>!s)} aria-expanded={show}>‚ãØ</button>
                <div className={`absolute right-0 mt-1 min-w-[200px] rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow ${show? 'opacity-100':'opacity-0 pointer-events-none'} transition-opacity`}>
                  <button className="w-full text-left px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-700" onClick={()=>{window.print(); setShow(false);}}>In / PDF</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      )
    }

    function BottomNav(){
      const [open, setOpen] = useState(false);
      const ref = useRef(null);
      useEffect(()=>{
        const click = (e)=>{ if (ref.current && !ref.current.contains(e.target)) setOpen(false); };
        document.addEventListener('mousedown', click);
        return ()=>document.removeEventListener('mousedown', click);
      }, []);
      return (
        <nav className="bottom-nav fixed bottom-0 left-0 right-0 z-30 p-2 flex justify-center font-display uppercase">
          <div className="flex gap-2">
            <a href="https://thiensutinhquang.github.io/home/" target="_blank" rel="noopener" className="px-4 h-11 rounded-xl bg-black text-white inline-flex items-center shadow-glow">Trang ch·ªß</a>
            <a href="https://thiensutinhquang.github.io/PlayMusic/" target="_blank" rel="noopener" className="px-4 h-11 rounded-xl bg-gradient-to-r from-pink-600 to-purple-600 text-white inline-flex items-center shadow-glow">Play Nh·∫°c</a>
            <div className={`group relative ${open ? 'overflow-visible' : ''}`} ref={ref}>
              <button className="px-4 h-11 rounded-xl bg-black/90 text-white inline-flex items-center shadow-glow" onClick={()=>setOpen(o=>!o)}>N·ªÅn t·∫£ng</button>
              <div className={`absolute left-1/2 -translate-x-1/2 bottom-[52px] flex gap-2 bg-black/80 border border-white/30 rounded-xl p-2 backdrop-blur-md ${open? 'opacity-100':'opacity-0 pointer-events-none'} transition-opacity`}>
                <a href="https://www.youtube.com/@ThiensuTinhQuang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="YouTube" src="https://upload.wikimedia.org/wikipedia/commons/0/09/YouTube_full-color_icon_%282017%29.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/ff0000/ffffff?text=YT'}}/></a>
                <a href="https://www.tiktok.com/@minhsutinhquang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="TikTok" src="https://static-00.iconduck.com/assets.00/tiktok-icon-2048x2048-15w2g25h.png" onError={(e)=>{e.target.src='https://placehold.co/28x28/ffffff/000?text=TT'}}/></a>
                <a href="https://www.facebook.com/groups/minhsutinhquang" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Facebook" src="https://upload.wikimedia.org/wikipedia/commons/1/1b/Facebook_icon.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/1877f2/fff?text=FB'}}/></a>
                <a href="https://t.me/Giaoly_phap_don_ngo" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Telegram" src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/229ed9/fff?text=TG'}}/></a>
                <a href="https://zalo.me/g/dukrae245" target="_blank" rel="noopener" className="w-10 h-10 grid place-items-center rounded-md hover:bg-white/10"><img className="w-7 h-7" alt="Zalo" src="https://upload.wikimedia.org/wikipedia/commons/9/91/Icon_of_Zalo.svg" onError={(e)=>{e.target.src='https://placehold.co/28x28/0068ff/fff?text=ZL'}}/></a>
              </div>
            </div>
          </div>
        </nav>
      )
    }
    
    /* ========================= App ========================= */
    function App(){
      const {focus} = useContext(Ctx);
      const [loading, setLoading] = useState(true);
      useEffect(()=>{ const t=setTimeout(()=>setLoading(false), 300); return ()=>clearTimeout(t) },[]);
      if (loading) return (
        <div className="max-w-6xl mx-auto mt-24 space-y-6 p-4" aria-busy>
          <div className="shimmer rounded-xl h-28"></div>
          <div className="shimmer rounded-xl h-20"></div>
          <div className="shimmer rounded-xl h-20"></div>
          <div className="shimmer rounded-xl h-20"></div>
        </div>
      );
      return (
        <div className={focus? 'reduce-motion':''}>
          <ProgressBar/>
          <CommandBar/>

          <main className={`max-w-6xl mx-auto pt-16 px-4 ${focus? 'opacity-95':''}`}>
            <CoreBlock/>
            {kv(DATA.sections).map(([id, sec])=> <Section key={id} idx={id} sec={sec}/>) }

            <aside className="bg-white dark:bg-slate-800 rounded-xl shadow p-6 my-8">
              <h2 className="text-2xl font-semibold mb-3">H∆∞·ªõng d·∫´n nhanh</h2>
              <ul className="list-disc list-inside space-y-2 text-sm">
                <li>T√¨m ki·∫øm t·ª©c th·ªùi <Kbd keys="Ctrl/‚åò + /"/> ho·∫∑c g√µ thanh t√¨m ki·∫øm.</li>
                <li>M·ªü h·ªôp l·ªánh <Kbd keys="Ctrl/‚åò + K"/> ƒë·ªÉ thao t√°c nhanh; In/PDF <Kbd keys="Ctrl/‚åò + P"/>.</li>
                <li>ƒê·ªïi ch·ªß ƒë·ªÅ (Light/Dark/Sepia), b·∫≠t <em>T·∫≠p trung</em> ƒë·ªÉ gi·∫£m nhi·ªÖu, l∆∞u ti·∫øn ƒë·ªô t·ª± ƒë·ªông.</li>
                <li>Ghi ch√∫ ri√™ng tr√™n t·ª´ng th·∫ª ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông v√†o thi·∫øt b·ªã c·ªßa b·∫°n.</li>
              </ul>
            </aside>
          </main>

          <BottomNav/>
        </div>
      )
    }

    const Root = () => (
      <Provider>
        <App/>
      </Provider>
    );

    ReactDOM.createRoot(document.getElementById('root')).render(<Root/>);
  </script>
</body>
</html>

